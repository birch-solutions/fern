irVersion: v46
publish:
  workingDirectory: generators/java
  preBuildCommands:
    - ./gradlew :model:distTar
  docker: 
    file: ./generators/java/model/Dockerfile
    image: fernapi/fern-java-model
    context: ./generators/java/model
test:
  docker:
    image: fernapi/fern-java-model:latest
    command: 
      - cd generators/java
      - ./gradlew :model:distTar
      - docker build -f model/Dockerfile -t fernapi/fern-java-model:latest model/
  local:
    workingDirectory: generators/java
    buildCommand:
      - ./gradlew :model:distTar
      - chmod +x install-gradle.sh && ./install-gradle.sh
      - cd model
      - tar -xvf build/distributions/model.tar -C .
    runCommand: cd model/model && java -cp model.jar:lib/* com.fern.java.model.Cli
  env: {}
language: java
generatorType: Model
defaultOutputMode: github
scripts:
  - docker: fernapi/java-seed
    commands:
      - source ~/.bash_profile 
      - ./gradlew compileJava
      - jenv shell 1.8 && source ~/.bash_profile && ./gradlew compileJava
allowedFailures:
  - enum
  - exhaustive
  - extends
  - multi-url-environment
  - reserved-keywords
  - trace
  - unions
  - alias-extends
    # below are all recent breaks from when we made cli capture failures better
  - alias
  - any-auth
  - api-wide-base-path
  - audiences
  - auth-environment-variables
  - basic-auth
  - basic-auth-environment-variables
  - bearer-token-environment-variable
  - bytes
  - examples
  - extra-properties
  - file-download
  - file-upload
  - imdb
  - literal
  - multi-url-environment-no-default
  - no-environment
  - oauth-client-credentials
  - oauth-client-credentials-default
  - oauth-client-credentials-environment-variables
  - oauth-client-credentials-nested-root
  - object
  - objects-with-imports
  - optional
  - package-yml
  - pagination
  - plain-text
  - simple-fhir
  - single-url-environment-no-default
  - streaming
  - streaming-parameter
  - undiscriminated-unions
  - unknown
  - variables
